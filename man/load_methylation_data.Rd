% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/load_data.R
\name{load_methylation_data}
\alias{load_methylation_data}
\title{Load and Process Methylation Data from Bismark Coverage Files}
\usage{
load_methylation_data(
  metadata,
  idat_repository,
  sample_name_variable,
  treatment_variable,
  mincov,
  individual_sample_plot = TRUE,
  filter_high_percentage = TRUE,
  normalization_coverage = TRUE,
  method_normalization = "median",
  output_folder,
  assembly = "hg38"
)
}
\arguments{
\item{metadata}{A data frame containing metadata for the samples. It must include:
- A column (name given by `sample_name_variable`) whose values are reported also in
    the Bismark coverage file names (excluding the `.bismark.cov.gz` extension).
- A numeric vector column (name given by `treatment_variable`) encoding the treatment groups,
    with length equal to the number of samples/files.}

\item{idat_repository}{Path to directory containing Bismark coverage files where the samples are ordered as in the metadata(`*.bismark.cov.gz`).}

\item{sample_name_variable}{Character string specifying the metadata column with sample names.}

\item{treatment_variable}{Character string specifying the metadata column with numeric treatment encoding.}

\item{mincov}{Minimum coverage threshold per CpG site (integer >= 1).}

\item{individual_sample_plot}{Logical, whether to generate coverage and methylation plots per sample.}

\item{filter_high_percentage}{Logical, whether to filter out sites with extremely high coverage (top 0.1%).}

\item{normalization_coverage}{Logical, whether to normalize coverage across samples before uniting.}

\item{method_normalization}{Character string specifying the normalization method to use if \code{normalization_coverage = TRUE}. Must be one of: `"median"` (default) or `"mean"`.}

\item{output_folder}{Path to output folder for saving intermediate files (currently unused).}

\item{assembly}{Genome assembly name (default: `"hg38"`).}
}
\value{
A \code{methylBase} object representing united methylation data across all samples.
}
\description{
Reads Bismark coverage files (`*.bismark.cov.gz`) from a directory and processes methylation data
using metadata with sample names and treatment information.
}
\details{
The metadata must meet the following requirements:
  The sample names in `metadata[[sample_name_variable]]` must exactly match
        the coverage file names (without extensions) in `idat_repository`.
  The treatment column specified by `treatment_variable` must be numeric and have the same length as the sample names.

The function uses \code{methylKit} to read, normalize, filter, and unite methylation data.
If \code{individual_sample_plot} is TRUE, plots for methylation and coverage statistics per sample are generated.
If \code{normalization_coverage} is TRUE, coverage will be normalized using the specified method (\code{"median"} or \code{"mean"}) before uniting data.
}
