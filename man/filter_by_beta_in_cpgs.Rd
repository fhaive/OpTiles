% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/betavalues_mean_variance.R
\name{filter_by_beta_in_cpgs}
\alias{filter_by_beta_in_cpgs}
\title{Filter CpG Sites by Beta Value Range Across Groups}
\usage{
filter_by_beta_in_cpgs(
  betavalue_df,
  threshold_delta_beta = 25,
  doplot = TRUE,
  groups
)
}
\arguments{
\item{betavalue_df}{A `data.frame` of beta values (percent methylation), where rows are CpG sites and columns are samples.}

\item{threshold_delta_beta}{A numeric threshold (in range min(betavalues)–max(betavalues)) above which a CpG site is considered too variable and is removed.}

\item{doplot}{Logical. If `TRUE`, a histogram of delta beta values across groups is plotted.}

\item{groups}{A character vector of group labels to search within column names of `betavalue_df` (e.g., control sample identifiers).}
}
\value{
A character vector of CpG site row names that passed the filtering (i.e., all groups have delta beta < threshold).
}
\description{
This function filters a beta value matrix by computing the difference (max - min) 
in beta values within defined groups. CpGs with a difference greater than 
or equal to a specified threshold are excluded.
}
\details{
- For each group, all columns in `betavalue_df` whose names contain the group label are extracted.
- For each CpG (row), the range of beta values across replicates in each group is computed.
- CpGs where any group has a delta beta ≥ `threshold_delta_beta` are filtered out.
}
\examples{
\dontrun{
selected_cpgs <- filter_by_beta_in_controls(
  betavalue_df = beta_matrix,
  threshold_delta_beta = 25,
  doplot = TRUE,
  groups = c("control1", "control2")
)
}

}
