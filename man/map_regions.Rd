% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cpg_and_gene_annotation.R
\name{map_regions}
\alias{map_regions}
\title{Map Genomic Regions and CpG Sites to Annotated Genomic Windows}
\usage{
map_regions(sample_to_map, annotation, origin_annotation = NA)
}
\arguments{
\item{sample_to_map}{A `data.frame` containing the sample regions and CpG coordinates to be mapped.
Must contain columns: \code{region_id}, \code{chr}, \code{start}, \code{end}.}

\item{annotation}{A `data.frame` of annotated genomic regions. Must contain at least the column:
\code{location} (in "chr:start-end" format). If \code{origin_annotation = "gene"}, it must also contain
columns \code{gene} and \code{gene_loci}.}

\item{origin_annotation}{A `character` indicating the type of annotation:
\itemize{
  \item \code{"gene"} — gene-based annotations. Requires \code{gene} and \code{gene_loci} columns in \code{annotation}.
  \item \code{"enhancer"} — adds "enhancer" as value to \code{gene_loci}.
  \item \code{"CpGI"} or \code{"CpGIslands"} — adds "CpGI" as value to \code{gene_loci}.
  \item \code{NULL} or {NA} — gene and gene_loci columns will be NA.
}}
}
\value{
A `data.frame` with:
\describe{
  \item{`annotation_regions`}{Original annotation region ID.}
  \item{`region_id`}{ID of the region from \code{sample_to_map} overlapping the annotation.}
  \item{`overlap_window`}{Genomic coordinates of the overlapping window.}
  \item{`overlap_bp`}{Number of overlapping base pairs.}
  \item{`pct_tile`}{Percent overlap relative to the annotation region.}
  \item{`pct_merged`}{Percent overlap relative to the sample region.}
  \item{`overlapping_NCpGs`}{Number of CpG sites overlapping the region.}
  \item{`gene`, `gene_loci`}{(Optional) Gene and gene loci associated with the annotation region, if applicable.}
}
}
\description{
This function maps sample regions and CpG sites to annotated genomic regions,
computes overlaps, and summarizes how many CpG sites overlap each annotation window.
}
\details{
This function performs a two-step mapping:
\enumerate{
  \item Maps sample regions to annotations via overlap (using \code{\link{map_regions_to_regions}}).
  \item Maps CpG sites to the overlapping windows (using \code{\link{map_cpg_to_regions}}).
}
It then merges the results and optionally adds gene or enhancer information.
}
\seealso{
\code{\link{map_regions_to_regions}}, \code{\link{map_cpg_to_regions}}
}
